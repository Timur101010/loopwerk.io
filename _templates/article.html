{% extends "base.html" %}

{% block title %}: {{ post.title }}{% endblock %}

{% block extraheader %}
  <link rel="canonical" href="{{ site.url }}{{ post|permalink }}" />
  <meta name="description" content="{% if post.description_source %} {{ post.description_source|striptags }} {% else %} {{ post.content|striptags|truncate }} {% endif %}" />
  <link rel="stylesheet" href="/static/not-home.css" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@kevinrenskers" />
  <meta name="twitter:image" content="{{ site.url }}/static/images/loopwerk.svg" />
  <meta property="og:url" content="{{ site.url }}{{ post|permalink }}" />
  <meta property="og:title" content="{{ post.title }} | {{ site.name }}" />
  <meta property="og:description" content="{% if post.description_source %} {{ post.description_source|striptags }} {% else %} {{ post.content|striptags|truncate }} {% endif %}" />
{% endblock %}

{% block main %}
  <div id="content">
    {% set wordcount = post.content|striptags|wordcount %}

    <article itemscope itemtype="{% if post.review %}http://schema.org/Review{% else %}http://schema.org/BlogPosting{% endif %}">
      <meta itemprop="author" itemscope itemtype="https://schema.org/Person">
        <meta itemprop="name" content="{{ post.author.name }}" />
      </meta>

      {% if post.review %}
        <meta itemprop="itemReviewed" itemscope itemtype="https://schema.org/Book">
          <meta itemprop="name" content="{{ post.review }}" />
        </meta>
        <meta itemprop="reviewRating" itemscope itemtype="https://schema.org/Rating">
          <meta itemprop="ratingValue" content="{{ post.rating }}" />
        </meta>
      {% else %}
        <meta itemprop="wordCount" content="{{ wordcount }}" />
      {% endif %}

      <h1 itemprop="headline">{{ post.title }}</h1>

      <div class="article_info"><span class="time">{{ post.date.strftime('%B') }} {{ post.date.strftime('%d') }},
        <a href="{{ content_url(site.prefix, post.date.strftime('%Y'), 'index.html') }}">{{ post.date.strftime('%Y') }}</a></span>{{ post.content|striptags|wordcount }} words{%- if post.tags -%}
        , posted in {% for tag in post.tags -%}
        {%- if loop.index > 1 %}, {% endif -%}
        <a href="{{ tag|tag_url }}">{{ tag }}</a>
        {%- endfor -%}
        {%- endif -%}
      </div>

      <div class="article_content" itemprop="{% if post.review %}reviewBody{% else %}articleBody{% endif %}">
        {{ post.content }}
      </div>
    </article>

    <div id="article_footer">
      <p>Have feedback? Let me know on <a href="https://twitter.com/kevinrenskers">Twitter</a>.</p>
    </div>
  </div>
{% endblock %}
